# 機能仕様：推奨栄養摂取量の自動計算

## 概要

ユーザーのプロフィール情報（年齢、性別、体重、身長、活動レベル）を基に、個別化された1日の推奨摂取カロリーおよびPFC（タンパク質・脂質・炭水化物）バランスを自動計算し、目標値として設定する機能の設計仕様。

## 1. 基礎代謝量 (BMR) の計算

生命維持に必要な最小限のエネルギーである「基礎代謝量（Basal Metabolic Rate）」を、以下の**ハリス・ベネディクト方程式（改良版）**を用いて算出する。

* **男性:**
    `88.362 + (13.397 × 体重kg) + (4.799 × 身長cm) - (5.677 × 年齢)`

* **女性:**
    `447.593 + (9.247 × 体重kg) + (3.098 × 身長cm) - (4.330 × 年齢)`

## 2. 1日の総消費カロリー (TDEE) の計算

ユーザーの日常的な活動レベルを考慮し、BMRに活動係数を乗じることで、1日の総消費カロリー（Total Daily Energy Expenditure）を推定する。

### 活動レベル係数

| 活動レベル | 説明 | 係数 |
| :--- | :--- | :--- |
| **低い** | 座り仕事が中心で、ほとんど運動しない | `1.2` |
| **普通** | 週に1〜3回程度の軽い運動やトレーニングを行う | `1.375` |
| **高い** | 週に3〜5回程度の中強度の運動やトレーニングを行う | `1.55` |
| **非常に高い**| 週に6〜7回程度の激しい運動やトレーニングを行う | `1.725` |
| **超高い** | 非常に強度の高い仕事や、ほぼ毎日の激しいトレーニングを行う | `1.9` |

**計算式:**
`TDEE = BMR × 活動レベル係数`

## 3. 目標設定カロリーの決定

ユーザーの目的に応じて、TDEEから増減させた値を最終的な目標カロリーとする。

* **減量目的:** `TDEE - 500 kcal`
* **維持目的:** `TDEE`
* **増量目的:** `TDEE + 500 kcal`

## 4. PFCバランスの設定

決定した目標設定カロリーを、以下の比率でタンパク質・脂質・炭水化物に分配する。
（この比率は、一般的な健康維持を目的としたバランスであり、設定で変更可能にすることも視野に入れる）

* **タンパク質 (Protein):** 20%
* **脂質 (Fat):** 25%
* **炭水化物 (Carbohydrate):** 55%

### グラムへの換算

各栄養素のカロリーからグラムへの換算係数を用いて、最終的な目標グラム数を算出する。

* **タンパク質:** 1gあたり `4 kcal`
* **脂質:** 1gあたり `9 kcal`
* **炭水化物:** 1gあたり `4 kcal`

**計算例（タンパク質）:**
`目標タンパク質(g) = (目標設定カロリー × 0.20) / 4`