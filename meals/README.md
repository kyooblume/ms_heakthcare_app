# Meals アプリケーション

## 概要

このアプリケーションは、ユーザーの日々の食事記録を管理する機能を提供します。朝食、昼食、夕食、間食といった食事の枠組み（`Meal`）と、それに含まれる個々の品目（`MealItem`）を記録し、摂取した栄養素を管理します。

手動での記録はもちろん、`products`アプリケーションと連携したバーコードスキャンによる自動記録にも対応しています。

## 主な機能

### 1. 食事記録の管理 (CRUD)

* **APIエンドポイント:** `/api/meals/records/`
* **役割:** ユーザーがその日に食べた食事の記録を、作成(Create)、読み取り(Read)、更新(Update)、削除(Delete)するための基本的なAPIです。
* **仕組み:**
    1.  まず、「朝食」や「昼食」といった`Meal`の枠を作成します。
    2.  作成した`Meal`の中に、食べた品目である`MealItem`（例：ごはん、200kcal）を複数追加していくことで、食事全体の記録が完成します。

### 2. バーコードからの食事記録

* **APIエンドポイント:** `/api/meals/add-from-barcode/`
* **役割:** `products`アプリのバーコード検索機能と連携し、スキャンした商品を簡単操作で食事として記録します。
* **仕組み:**
    1.  フロントエンドが、商品のバーコード番号、食べた量（例: 250g）、食事タイプ（例: snack）をこのAPIに送信します。
    2.  バックエンドは、`ProductNutrition`モデルにキャッシュされた栄養情報を元に、食べた量に応じた摂取栄養素を自動で計算します。
    3.  その日の該当する食事タイプの`Meal`に、新しい`MealItem`として自動で追加・保存します。

## データベースモデル

### `Meal`

* **役割:** 「2025年7月15日の朝食」といった、食事全体の枠組みを管理します。
* **主なフィールド:**
    * `user`: この食事を記録したユーザー。
    * `meal_type`: 'breakfast', 'lunch', 'dinner', 'snack' のいずれか。
    * `recorded_at`: 食事の日時。

### `MealItem`

* **役割:** `Meal`に含まれる、個々の食品や料理を記録します。「ごはん」や「みそ汁」がこれにあたります。
* **主なフィールド:**
    * `meal`: どの`Meal`に属しているかを示す外部キー。
    * `food_name`: 食品名。
    * `calories`, `protein`, `fat`, `carbohydrates`: 摂取した栄養素。
    * `quantity`, `unit`: 食べた量と単位。
